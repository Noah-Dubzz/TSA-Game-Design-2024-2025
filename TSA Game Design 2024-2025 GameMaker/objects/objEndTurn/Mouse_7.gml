// Check if global.doingsomething is false, and end the turn if so
if (!global.doingsomething) {
    global.endturn = true;
}